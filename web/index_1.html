<!DOCTYPE html>

<html>
    <head>
        <title>PhoneBook</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="lib/css/bootstrap.min.css" rel="stylesheet">
        <link href="lib/css/style.css" rel="stylesheet">
        <link rel="stylesheet" href="lib/css/bootstrap-theme.css" type="text/css"/>
        <script src="controllers/AbonentController.js"></script>
        <script src="controllers/AdminController.js"></script>
        <script src="controllers/PhoneNumberController.js"></script>
        <script src="service/AbonentService.js"></script>
        <script src="service/AdminService.js"></script>
        <script src="service/PhoneNumberService.js"></script>

        <script>
            function deleteClick(id)
            {
                var controller = new AbonentController();
                var controller2 = new PhoneNumberController();
                var abonentService = new AbonentService();
                var array = abonentService.getAllAbonent();
                //for(var i=0;i<array.length;i++){
                   // var id2 = array[id].phonenumber[1].id;
                    //alert(id2);
                if (confirm("Удалить абонента?")) {
                    controller2.deletePhoneNumberById(id);
                    controller.deleteAbonentById(id);
                    alert("Абонент удален.")
                }
            //}
            }
            function search()
            {
                 var element2 =document.getElementById("abonent2");
                 element2.innerHTML = "";
                var search = document.form1.fullname.value;
                var search2 = document.form1.phone.value;
                var abonentService = new AbonentService();
                var array = abonentService.getAllAbonent();
                var check = 0;
                if (search != "") {
                    var result = "<div>";
                    // var i = array.length;
                    // while (i--) {
                    for (var i = 0; i < array.length; i++) {
                        if (array[i].lastName + " " + array[i].firstName + " " + array[i].patronymic == search) {
                            var controller = new AbonentController();
                            controller.getAbonentByIdView(array[i].id);
                            check = 1;
                        } else if ((array[i].lastName == search) || (array[i].firstName == search) || (array[i].patronymic == search)) {
                            var controller = new AbonentController();
                            controller.getAbonentByIdView(array[i].id);
                            check = 1;
                        }
                    }
                    if(check==0){
                    alert("Абонент не найден");}
                } else if (search2 != "") {

                    for (var i = 0; i < array.length; i++) {
                        for (var j = 0; j < array[i].phonenumber.length; j++) {
                            if (array[i].phonenumber[j].phoneNum == search2) {
                                var controller = new AbonentController();
                                controller.getAbonentByIdView(array[i].id);
                                check = 1;
                            }
                        }
                    }
                    if(check==0){
                    alert("Абонент не найден");}

                } else
                    alert("Введите ФИО или номер телефона абонента");

            }

            function load()
            {   document.form1.fullname.value=""
                document.form1.phone.value="";
                var element2 =document.getElementById("abonent2");
                element2.innerHTML = "";
                var controller = new AbonentController();
                controller.getAllAbonentView();
            }
        </script>
    </head>
    <body  style="background-image: url(/Phonebook/images/rrr.jpg);">
        <div class="container">
            <div class="row" style="background-color: white; width:1200px">
                <div class="span12"  style="background-color: white; width: 1150px">
                    <div class="head">
                        <div class="row-fluid">
                            <div class="span12">
                                <div class="span6">
                                    <h1 class="muted">PHONEBOOK</h1>
                                </div>

                                <div class="span4 offset2" style="margin-top:15px;">
                                    <button class="btn pull-right" type="button">Sign In</button>
                                </div>
                            </div>
                        </div>

                        <div class="navbar">
                            <div class="navbar-inner">
                                <div class="container">
                                    <ul class="nav">
                                        <li>
                                            <a href="/Phonebook/index_1.html">Главная</a>
                                        </li>
                                        <li>
                                            <a href="/Phonebook/view/add.html">Добавить</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container"  style="background-color: white;width: 1200px; padding-top: 30px;margin-top: 10px;">
            <div class="row">

                <div  class="span0"></div>
                <form class="form-horizontal" name="form1">
                    <fieldset >

                        <!-- Form Name -->
                        <legend style="background-color:#f7f7f7;margin-left: 20px;padding-left: 20px;width: 1140px">Поиск</legend>

                        <!-- Text input-->
                        <div style="margin-left: 50px;" class="form-group">
                            <label class="col-md-4 control-label" for="textinput">ФИО</label>  
                            <div class="col-md-8">
                                <input id="textinput" name="fullname" type="text" placeholder="Фамилия Имя Отчество" class="form-control input-md"> 
                            </div>
                        </div>
                        <!-- Text input-->
                        <div style="margin-left: 50px;" class="form-group">
                            <label class="col-md-4 control-label" for="textinput">Номер телефона</label>  
                            <div class="col-md-8">
                                <input id="textinput" name="phone" type="text" placeholder="8-888-888-88-88" class="form-control input-md">  
                            </div>
                        </div>
                        <!-- Button -->
                        <div style="margin-left: 50px;" class="form-group">
                            <label class="col-md-4 control-label" for="singlebutton"></label>
                            <div class="col-md-4">
                                <button type="button" onclick="search()" id="singlebutton" name="button" class="btn btn-success">Поиск</button>
                                <button type="button" onclick="load()" id="singlebutton" name="button" class="btn btn-danger">Cбросить</button>
                            </div>
                            <div  class="col-lg-2 col-md-2 col-sm-2 col-xs-2" id="mur"></div>
                            <div id="abonent2" style="margin-left:-50px;"></div> 
                        </div>                      
                        <legend style="background-color:#f7f7f7;margin-left: 20px;padding-left: 20px;width: 1140px">Справочник</legend>                        
                        <div id="abonent" style="width: 150%;margin-top: -50px;"></div>                      
                    </fieldset>                    
                </form>
            </div>
        </div>

        <!--  ================================================== -->
        <script src="lib/js/jquery.min.js"></script>
        <script src="lib/js/bootstrap.min.js"></script>
        <script>
            window.onload = function ()
                {
                var controller = new AbonentController();
                controller.getAllAbonentView();
                }
        </script>
    </body>
</html>